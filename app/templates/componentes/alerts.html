<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Inyectamos los mensajes como JSON string desde Jinja (sin que el linter se queje)
        const flashMessages = JSON.parse('{{ messages | tojson | safe }}');

        for (const [category, message] of flashMessages) {
          const validCategories = ['success', 'error', 'warning', 'info'];
          const icon = validCategories.includes(category) ? category : 'info';

          Swal.fire({
            icon: icon,
            html: message,
            confirmButtonText: 'OK',
            timer: 5000,
            timerProgressBar: true,
            allowOutsideClick: false,
            allowEscapeKey: true
          });
        }
      });
    </script>
  {% endif %}
{% endwith %}
